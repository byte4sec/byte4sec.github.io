<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>mysql允许最大sql语句长度配置 - Hello boy !</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hello boy !"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hello boy !"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="MySQL对于每个客户端连接都会分配连接buffer和结果集发送的buffer，连接buffer主要就是来接受客户端发送过来的sql语句，并且初始分配大小都是 net_buffer_length，可以动态增长，最多可以达到 max_allow_packet大小。这个参数是会话只读的，言外之意就是只能全局修改，新建连接才生效。max_allow_packet是MySQL控制网络包大小的参数，默认是4"><meta property="og:type" content="blog"><meta property="og:title" content="byte4sec"><meta property="og:url" content="https://byte4sec.github.io/"><meta property="og:site_name" content="Hello boy !"><meta property="og:description" content="MySQL对于每个客户端连接都会分配连接buffer和结果集发送的buffer，连接buffer主要就是来接受客户端发送过来的sql语句，并且初始分配大小都是 net_buffer_length，可以动态增长，最多可以达到 max_allow_packet大小。这个参数是会话只读的，言外之意就是只能全局修改，新建连接才生效。max_allow_packet是MySQL控制网络包大小的参数，默认是4"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://byte4sec.github.io/img/avatar.png"><meta property="article:published_time" content="2020-03-25T09:46:12.000Z"><meta property="article:modified_time" content="2020-12-31T09:27:05.000Z"><meta property="article:author" content="byte4sec"><meta property="article:tag" content="mysql"><meta property="article:tag" content="慢sql"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/avatar.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://byte4sec.github.io/2020/03/25/mysql%E5%85%81%E8%AE%B8%E6%9C%80%E5%A4%A7sql%E8%AF%AD%E5%8F%A5%E9%95%BF%E5%BA%A6%E9%85%8D%E7%BD%AE/"},"headline":"Hello boy !","image":["https://cdn.jsdelivr.net/gh/removeif/blog_image/img/2020/20200325175024.png"],"datePublished":"2020-03-25T09:46:12.000Z","dateModified":"2020-12-31T09:27:05.000Z","author":{"@type":"Person","name":"byte4sec"},"description":"MySQL对于每个客户端连接都会分配连接buffer和结果集发送的buffer，连接buffer主要就是来接受客户端发送过来的sql语句，并且初始分配大小都是 net_buffer_length，可以动态增长，最多可以达到 max_allow_packet大小。这个参数是会话只读的，言外之意就是只能全局修改，新建连接才生效。max_allow_packet是MySQL控制网络包大小的参数，默认是4"}</script><link rel="canonical" href="https://byte4sec.github.io/2020/03/25/mysql%E5%85%81%E8%AE%B8%E6%9C%80%E5%A4%A7sql%E8%AF%AD%E5%8F%A5%E9%95%BF%E5%BA%A6%E9%85%8D%E7%BD%AE/"><link rel="icon" href="/img/favicon.ico"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="Hello boy !" height="28" style="max-height: 3.75rem;margin: -10px;"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/album">相册</a><a class="navbar-item" href="/message">留言</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://cdn.jsdelivr.net/gh/removeif/blog_image/img/2020/20200325175024.png" alt="mysql允许最大sql语句长度配置"></span></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2020-03-25  <a class="commentCountImg" href="/2020/03/25/mysql%E5%85%81%E8%AE%B8%E6%9C%80%E5%A4%A7sql%E8%AF%AD%E5%8F%A5%E9%95%BF%E5%BA%A6%E9%85%8D%E7%BD%AE/#comment-container"><span class="display-none-class">6a31fde287dc19e930a83ba31a5810a2</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="6a31fde287dc19e930a83ba31a5810a2">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>11 分钟  <i class="fas fa-pencil-alt"> </i>1.6 k</span></div></div><h1 class="title is-3 is-size-4-mobile">mysql允许最大sql语句长度配置</h1><div class="content"><p>MySQL对于每个客户端连接都会分配连接buffer和结果集发送的buffer，连接buffer主要就是来接受客户端发送过来的sql语句，并且初始分配大小都是 <code>net_buffer_length</code>，可以动态增长，最多可以达到 <code>max_allow_packet</code>大小。这个参数是会话只读的，言外之意就是只能全局修改，新建连接才生效。<code>max_allow_packet</code>是MySQL控制网络包大小的参数，默认是4M。有次可控制一条mysql查询语句大大小，实现mysql慢sql相关优化。<span id="more"></span></p>
<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>前几天在生产环境抓到一条慢SQL，内容大致如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select xxx from table where conditions and id in (in_list);</span><br></pre></td></tr></table></figure>

<p>这个SQL看起来貌似没有什么问题，但是 <code>in_list</code>的元素个数多达3000多个，然后我尝试统计了这个表的总数据量，刚好跟这个 <code>in_list</code>吻合，用大腿猜了下，应该是用了框架，先查出表里所有的数据放入list，再进行拼接生成的SQL，这尼玛不是蠢么。</p>
<h2 id="二、问题"><a href="#二、问题" class="headerlink" title="二、问题"></a>二、问题</h2><p>抛开这个蠢不蠢的问题，我比较关心的是在MySQL里面，这个 <code>in_list</code>的元素个数能不能控制。咨询了下叶师傅，加上自己搜索了一圈文档，很遗憾，MySQL没法限制这个 <code>in_list</code>的元素个数。那么既然没法控制 <code>in_list</code>，那我们是不是可以控制sql语句的长度呢？</p>
<p><strong>net_buffer_length</strong></p>
<p>MySQL有一个参数叫做 <code>net_buffer_length</code>，它是做什么用的呢？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Each client thread is associated with a connection buffer and result buffer. Both begin with a size given by net_buffer_length but are dynamically enlarged up to max_allowed_packet bytes as needed. The result buffer shrinks to net_buffer_length after each SQL statement.This variable should not normally be changed, but if you have very little memory, you can set it to the expected length of statements sent by clients. If statements exceed this length, the connection buffer is automatically enlarged. The maximum value to which net_buffer_length can be set is 1MB.The session value of this variable is read only.</span><br></pre></td></tr></table></figure>

<p>简单翻译一下的意思就是，MySQL对于每个客户端连接都会分配连接buffer和结果集发送的buffer，连接buffer主要就是来接受客户端发送过来的sql语句，并且初始分配大小都是 <code>net_buffer_length</code>，可以动态增长，最多可以达到 <code>max_allow_packet</code>大小。这个参数是会话只读的，言外之意就是只能全局修改，新建连接才生效。<code>max_allow_packet</code>是MySQL控制网络包大小的参数，默认是4M。</p>
<h2 id="三、测试"><a href="#三、测试" class="headerlink" title="三、测试"></a>三、测试</h2><p>既然是这样的话，我们就来测试一把，下面是我的测试过程。</p>
<p><strong>参数设置</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@mysqldb 16:58:  [(none)]&gt; show global variables like <span class="string">&#x27;net_buffer_length&#x27;</span>;</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Variable_name     | Value |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| net_buffer_length | 16384 |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@mysqldb 17:00:  [(none)]&gt; show global variables like <span class="string">&#x27;max_allowed_packet&#x27;</span>;</span><br><span class="line">+--------------------+--------+</span><br><span class="line">| Variable_name      | Value  |</span><br><span class="line">+--------------------+--------+</span><br><span class="line">| max_allowed_packet | 131072 |</span><br><span class="line">+--------------------+--------+</span><br></pre></td></tr></table></figure>

<p>这里我设置 <code>net_buffer_length</code>为16K， <code>max_allowed_packet</code>为128K</p>
<p><strong>测试脚本</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_in_list</span>(<span class="params">i</span>):</span></span><br><span class="line">    in_list = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,i):</span><br><span class="line">        in_list = <span class="built_in">str</span>(i) + <span class="string">&#x27;,&#x27;</span> + in_list</span><br><span class="line"></span><br><span class="line">    in_list = in_list + <span class="built_in">str</span>(i+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> in_list</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_mysql</span>(<span class="params">sql</span>):</span></span><br><span class="line">    conn = pymysql.connect(host=<span class="string">&#x27;127.0.0.1&#x27;</span>, user=<span class="string">&#x27;xucl&#x27;</span>,</span><br><span class="line">                           password=<span class="string">&#x27;xuclxucl123&#x27;</span>, database=<span class="string">&#x27;sbtest&#x27;</span>, charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    results = cursor.fetchall()</span><br><span class="line">    <span class="keyword">if</span> results:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;get results&quot;</span>)</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    in_list = get_in_list(<span class="number">100</span>)</span><br><span class="line">    sql = <span class="string">&quot;select * from sbtest1 where id in (&#123;&#125;)&quot;</span>.<span class="built_in">format</span>(in_list)</span><br><span class="line">    <span class="comment"># 打印出sql占用的字节数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(in_list.encode()))</span><br><span class="line">    exec_mysql(sql)</span><br></pre></td></tr></table></figure>



<p><strong>测试结果</strong></p>
<p>当i为4200时，sql大小为19892字节（大于 <code>net_buffer_length</code>），MySQL能正常返回数据，结果如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@izbp13wpxafsmeraypddyvz python_scripts]# python test.py 19892get results</span><br></pre></td></tr></table></figure>

<p>当i为23690时，sql大小为131033字节（小于 <code>max_allowed_packet</code>），也能正常输出，结果如下，此时sql的字节数为131033</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@izbp13wpxafsmeraypddyvz python_scripts]# python test.py 131033get results</span><br></pre></td></tr></table></figure>

<p>当i为23691时，sql大小为131039字节（仍然小于 <code>max_allowed_packet</code>），抛出异常</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@izbp13wpxafsmeraypddyvz python_scripts]<span class="comment"># python test.py </span></span><br><span class="line">131039</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;test.py&quot;</span>, line 29, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    exec_mysql(sql)</span><br><span class="line">  File <span class="string">&quot;test.py&quot;</span>, line 19, <span class="keyword">in</span> exec_mysql</span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">  File <span class="string">&quot;/usr/lib64/python2.7/site-packages/pymysql/cursors.py&quot;</span>, line 170, <span class="keyword">in</span> execute</span><br><span class="line">    result = self._query(query)</span><br><span class="line">  File <span class="string">&quot;/usr/lib64/python2.7/site-packages/pymysql/cursors.py&quot;</span>, line 328, <span class="keyword">in</span> _query</span><br><span class="line">    conn.query(q)</span><br><span class="line">  File <span class="string">&quot;/usr/lib64/python2.7/site-packages/pymysql/connections.py&quot;</span>, line 517, <span class="keyword">in</span> query</span><br><span class="line">    self._affected_rows = self._read_query_result(unbuffered=unbuffered)</span><br><span class="line">  File <span class="string">&quot;/usr/lib64/python2.7/site-packages/pymysql/connections.py&quot;</span>, line 732, <span class="keyword">in</span> _read_query_result</span><br><span class="line">    result.read()</span><br><span class="line">  File <span class="string">&quot;/usr/lib64/python2.7/site-packages/pymysql/connections.py&quot;</span>, line 1075, <span class="keyword">in</span> <span class="built_in">read</span></span><br><span class="line">    first_packet = self.connection._read_packet()</span><br><span class="line">  File <span class="string">&quot;/usr/lib64/python2.7/site-packages/pymysql/connections.py&quot;</span>, line 684, <span class="keyword">in</span> _read_packet</span><br><span class="line">    packet.check_error()</span><br><span class="line">  File <span class="string">&quot;/usr/lib64/python2.7/site-packages/pymysql/protocol.py&quot;</span>, line 220, <span class="keyword">in</span> check_error</span><br><span class="line">    err.raise_mysql_exception(self._data)</span><br><span class="line">  File <span class="string">&quot;/usr/lib64/python2.7/site-packages/pymysql/err.py&quot;</span>, line 109, <span class="keyword">in</span> raise_mysql_exception</span><br><span class="line">    raise errorclass(errno, errval)</span><br><span class="line">pymysql.err.InternalError: (1153, u<span class="string">&quot;Got a packet bigger than &#x27;max_allowed_packet&#x27; bytes&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>MySQL错误日志如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2020-03-10T09:07:46.992043Z 32 [Note] Aborted connection 32 to db: &#x27;sbtest&#x27; user: &#x27;xucl&#x27; host: &#x27;127.0.0.1&#x27; (Got a packet bigger than &#x27;max_allowed_packet&#x27; bytes)</span><br></pre></td></tr></table></figure>

<p><strong>释惑</strong></p>
<p>为什么sql字节数为131039&lt;131072（ <code>max_allowed_packet</code>大小），MySQL还是报错了呢？因为这里还需要加上MySQL的包头大小，这个包头的大小是多少呢？还是用i=23690的例子，在MySQL服务器上抓包</p>
<p><img src="https://cdn.jsdelivr.net/gh/removeif/blog_image/img/2020/20200325174658.png"></p>
<p>看到MySQL接收到的包大小是131070字节，那么这个包头大小就为37字节了（未深入研究，留到以后研究），而上述实验中i=23691的例子中，sql大小为131039字节，加上包头的大小37字节，总大小为131076字节，大于 <code>max_allowed_packet</code>的131072，所以MySQL报错，符合逻辑。</p>
<h2 id="四、结论"><a href="#四、结论" class="headerlink" title="四、结论"></a>四、结论</h2><p>经过这次测试，得出了以下节点结论</p>
<ul>
<li>虽然MySQL没有限制子查询内元素个数，但是还是不建议元素太多，会影响执行计划同时也会影响SQL解析的效率和内存占用</li>
<li>适当调大 <code>net_buffer_length</code>，最好能够一次性缓存sql，无需再分配内存，并且这是一个全局性参数</li>
<li>适当调大 <code>max_allowed_packet</code>大小，但是也不要分配过大，这是一个会话级变量，生产建议调为32M为佳</li>
<li>学会利用抓包解决”网络”相关的问题</li>
</ul>
<p>参考文章:<br><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/amzI5bhbkqiYt4BeVdQl0A">参考链接</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>mysql允许最大sql语句长度配置</p><p><a href="https://byte4sec.github.io/2020/03/25/mysql允许最大sql语句长度配置/">https://byte4sec.github.io/2020/03/25/mysql允许最大sql语句长度配置/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://byte4sec.github.io"><p>byte4sec</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2020-03-25</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2020-12-31</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2020/03/17/mysql-like%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/" target="_blank">mysql-like模糊查询优化</a><br></span><span>  2.<a class="is-size-6" href="/2019/12/10/mysql-b-Tree%E7%B4%A2%E5%BC%95/" target="_blank">mysql-b+Tree索引</a><br></span><span>  3.<a class="is-size-6" href="/2019/08/21/mysql%E9%AB%98%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E8%A7%84%E8%8C%83%E6%96%B9%E6%B3%95/" target="_blank">mysql高性能优化规范方法</a><br></span><span>  4.<a class="is-size-6" href="/2019/07/05/%E5%B8%B8%E8%A7%81sql%E9%94%99%E8%AF%AF%E5%86%99%E6%B3%95/" target="_blank">常见sql错误写法</a><br></span><span>  5.<a class="is-size-6" href="/2019/07/03/mysql%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/" target="_blank">mysql索引优化方案</a><br></span><span>  6.<a class="is-size-6" href="/2019/06/25/%E4%B8%80%E6%AC%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%AD%BB%E9%94%81%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E8%BF%87%E7%A8%8B/" target="_blank">一次数据库的死锁问题排查过程</a><br></span><span>  7.<a class="is-size-6" href="/2019/06/04/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95%E8%A7%A3%E6%9E%90/" target="_blank">mysql数据库索引解析</a><br></span><span>  8.<a class="is-size-6" href="/2019/04/18/%E4%B8%80%E5%8D%83%E8%A1%8C-MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E8%BD%AC%E8%BD%BD/" target="_blank">一千行 MySQL 学习笔记(转载)</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 推荐文章</span><br><span>  1.<a class="is-size-6" href="/2019/09/19/%E5%8D%9A%E5%AE%A2%E6%BA%90%E7%A0%81%E5%88%86%E4%BA%AB/" target="_blank">博客源码分享</a><br></span><span>  2.<a class="is-size-6" href="/2019/10/13/2019%E5%B9%B4%E5%9B%BD%E5%BA%8670%E5%91%A8%E5%B9%B4%E9%98%85%E5%85%B5%E5%AE%8C%E6%95%B4%E5%9B%BE%E6%96%87%E8%A7%A3%E8%AF%B4/" target="_blank">2019年国庆70周年阅兵完整图文解说(收藏!)</a><br></span><span>  3.<a class="is-size-6" href="/2019/09/13/%E5%8D%9A%E5%AE%A2%E4%B8%ADgitalk%E6%9C%80%E6%96%B0%E8%AF%84%E8%AE%BA%E7%9A%84%E8%8E%B7%E5%8F%96/" target="_blank">博客中gitalk最新评论的获取</a><br></span><span>  4.<a class="is-size-6" href="/2019/08/21/%E4%B8%AD%E5%8D%8E%E4%BA%BA%E6%B0%91%E5%85%B1%E5%92%8C%E5%9B%BD%E5%88%91%E4%BA%8B%E8%AF%89%E8%AE%BC%E6%B3%95/" target="_blank">中华人民共和国刑事诉讼法</a><br></span><span>  5.<a class="is-size-6" href="/2021/10/09/startup/" target="_blank">测试博客1</a><br></span><span>  6.<a class="is-size-6" href="/2020/09/19/hello-world1/" target="_blank">Hello World</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/favicon.svg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/favicon.svg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/07/02/java-strategy-pattern/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Java-策略模式</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/03/20/github-gpg-failed-to-sign-the-data/"><span class="level-item">github gpg failed to sign the data</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">评论</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '6a31fde287dc19e930a83ba31a5810a2',
            repo: 'byte4sec_blog_comment',
            owner: 'byte4sec',
            clientID: 'f88a486e05fdd7f69e07',
            clientSecret: 'bff4482197b90508db6ebfa68fa62b42ee68222f',
            admin: ["byte4sec"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#一、前言"><span>一、前言</span></a></li><li><a class="is-flex is-mobile" href="#二、问题"><span>二、问题</span></a></li><li><a class="is-flex is-mobile" href="#三、测试"><span>三、测试</span></a></li><li><a class="is-flex is-mobile" href="#四、结论"><span>四、结论</span></a></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://octodex.github.com/images/droidtocat.png" alt="byte4sec"></figure><p class="title is-size-4 is-block" style="line-height: 32px;">byte4sec<span style="font-size: xx-small;margin: 5px;"><i class="fas fa-map-marker-alt mr-1" style="padding-top: 4px;"></i><span>新西兰</span></span></p><p class="is-size-6 is-block" style="font-size: 12px !important;">少年易学老难成，一寸光阴不可轻!</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">125</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">47</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">97</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/byte4sec" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/byte4sec"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/byte4sec"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:byte4sec@gmail.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟缓存...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-13T02:57:19.124Z">2021-10-13</time></p><p class="title"><a href="/2021/10/13/hello-world/">博客源码分享</a></p><p class="categories"><a href="/categories/Plugins/">Plugins</a> / <a href="/categories/Plugins/Comment/">Comment</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-13T02:57:17.979Z">2021-10-13</time></p><p class="title"><a href="/2021/10/13/%E4%BD%A0%E5%A5%BD%E4%B8%96%E7%95%8C/">你好世界！</a></p><p class="categories"><a href="/categories/Plugins/">Plugins</a> / <a href="/categories/Plugins/Comment/">Comment</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-13T02:30:42.000Z">2021-10-13</time></p><p class="title"><a href="/2021/10/13/architect_test2/">架构测试文章2</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-13T02:30:31.000Z">2021-10-13</time></p><p class="title"><a href="/2021/10/13/architect_test1/">架构测试文章1</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-09T10:16:14.000Z">2021-10-09</time></p><p class="title"><a href="/2021/10/09/startup/">测试博客1</a></p><p class="categories"><a href="/categories/Web%E6%8A%80%E6%9C%AF/">Web技术</a> / <a href="/categories/Web%E6%8A%80%E6%9C%AF/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/">生活琐事</a> / <a href="/categories/Web%E6%8A%80%E6%9C%AF/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/%E7%AE%97%E6%B3%95%E7%BB%83%E4%B9%A0/">算法练习</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/English/"><span class="level-start"><span class="level-item">English</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/English/grammar/"><span class="level-start"><span class="level-item">grammar</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Plugins/"><span class="level-start"><span class="level-item">Plugins</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Plugins/Comment/"><span class="level-start"><span class="level-item">Comment</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Web%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">Web技术</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Web%E6%8A%80%E6%9C%AF/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/"><span class="level-start"><span class="level-item">生活琐事</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Web%E6%8A%80%E6%9C%AF/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/%E7%AE%97%E6%B3%95%E7%BB%83%E4%B9%A0/"><span class="level-start"><span class="level-item">算法练习</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/algorithm/"><span class="level-start"><span class="level-item">algorithm</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/develop/"><span class="level-start"><span class="level-item">develop</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/develop/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/English/"><span class="tag">English</span><span class="tag is-grey-lightest">19</span></a></div><div class="control"><a class="tags has-addons" href="/tags/grammar/"><span class="tag">grammar</span><span class="tag is-grey-lightest">19</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag is-grey-lightest">19</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%95%E5%BE%8B/"><span class="tag">法律</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">设计模式</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B7%A5%E5%85%B7%E6%95%99%E7%A8%8B/"><span class="tag">工具教程</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Getting-Started/"><span class="tag">Getting Started</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Icarus-User-Guide/"><span class="tag">Icarus User Guide</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/springboot/"><span class="tag">springboot</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/think/"><span class="tag">think</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"><span class="tag">二分查找</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dp/"><span class="tag">dp</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/elasticsearch6/"><span class="tag">elasticsearch6</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo%E4%B8%BB%E9%A2%98/"><span class="tag">hexo主题</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/icarus%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE/"><span class="tag">icarus主题配置</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redis/"><span class="tag">redis</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring/"><span class="tag">spring</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"><span class="tag">动态规划</span><span class="tag is-grey-lightest">2</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer" style="padding: 3rem 1.5rem 3rem;"><div class="container"><div class="copyright" style="text-align: center;padding: 0;"><p>©   2020 - 2021   byte4sec </p><p>Power By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span> Theme By </span><a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>&amp;<a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a></p></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('f88a486e05fdd7f69e07','bff4482197b90508db6ebfa68fa62b42ee68222f','byte4sec','byte4sec_blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('f88a486e05fdd7f69e07','bff4482197b90508db6ebfa68fa62b42ee68222f','byte4sec','byte4sec_blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>